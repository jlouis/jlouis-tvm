%{

********* TESTS *********

}%

%{
prg0 : tm tp/nat =
    tm/letrec ([fg] fun-def-list/cons
	      (fun-def/parm [x] fun-def/body
		 (tm/plus (tm/br (f-hd (f-tl/s (f-tl/z fg)))
			     (reg-list/cons x
				(reg-list/cons
				   (reg/cst-n 3)
				   reg-list/nil)))
		          (tm/reg (reg/cst-n 2))))
	      (fun-def-list/cons
		 (fun-def/parm [x] fun-def/parm [y] fun-def/body
		    (tm/plus (tm/reg (reg/cst-n 2))
		             (tm/br (f-hd (f-tl/z fg)) (reg-list/cons x reg-list/nil))))
		 fun-def-list/nil))
	([fg] tm/br (f-hd (f-tl/z fg)) (reg-list/cons (tm/reg (reg/cst-n 0)) reg-list/nil)).

prg1 : tm tp/nat =
    tm/letrec ([fg] fun-def-list/cons
	            (fun-def/parm [x : tm tp/nat] fun-def/body
		       (tm/plus x
		          (tm/cst-n 2)))
	      (fun-def-list/cons
		    (fun-def/parm [x : tm tp/nat] fun-def/body
		       (tm/plus (tm/cst-n 2)
			  (tm/call (f-hd (f-tl/z fg)) (reg-list/cons x reg-list/nil))))
		 fun-def-list/nil))
	([fg] tm/call (f-hd (f-tl/s (f-tl/z fg))) (reg-list/cons (tm/cst-n 1) reg-list/nil)).

%query 1 2 (steps-to prg1 V).
}%
